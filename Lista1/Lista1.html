<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml">

<head>
    <meta charset="UTF-8">
    <title>Cálculo Numérico 2018.1</title>
    Profª: Juliana Vianna Valerio <br>
    <a href="https://sites.google.com/site/cnuufrjcc20181/home" target="_blank">Página do Curso</a>  <br>
    <a href="https://drive.google.com/file/d/1o71M0uQJEsyI0gSwmm-DgpEN7N22tRKU/view" target="_blank">Lista 1</a>
    <script type="text/x-mathjax-config">MathJax.Hub.Config({
        MathML: {
          extensions: ["mml3.js"]
        }
      });
      </script>
    <script type="text/x-mathjax-config">
        MathJax.Hub.Config({
          MathML: {
            extensions: ["content-mathml.js"]
          }
        });
    </script>
    <script type="text/javascript" src='https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.4/latest.js?config=TeX-MML-AM_CHTML' async></script>
    <!--
    Documentação MathML = https://www.w3.org/TR/MathML3/
    -->
    <body>
        </head>
    <div id="questao1">
        
        <h4>
            1) Em cada um dos itens abaixo são dados um número p e uma aproximação ṗ de p. <br> 
            Determine, em cada caso, o erro absoluto, o erro relativo e a quantidade de algarismos corretos.
        </h4>

        <div>
            <b>Erro absoluto:</b><br>
            Diferença entre a valor exato de um número x e o seu valor aproximado ẋ.<br>
            <b>EAx = x – ẋ</b>
        </div>
        <br>
        <div>
            <b>Erro relativo:</b><br>
            Como dependendo das grandezas envolvidas o erro absoluto pode não ser muito significativo, <br>
            portanto empregamos o erro relativo que é o erro absoluto dividido pelo valor exato  x: <br>
            <b>ERx = EAx/x</b>
        </div>
        <br>
        Determine, em cada caso, o erro absoluto, o erro relativo e a quantidade de algarismos corretos:
        <div id="respostaQuestao1">
            <b>
                a) 
                <math style="font-size: 18px" xmlns="http://www.w3.org/1998/Math/MathML">
                    <mi>p</mi>
                    <mo>=</mo>
                    <mfrac>
                        <mn>1</mn>
                        <mi>e</mi>
                    </mfrac>
                    <mo>,</mo>
                    <mspace width="0.3em"></mspace>
                    <mi>ṗ</mi>
                    <mo>=</mo>
                    <mn>0.3666</mn>
                    <mo>:</mo>
                </math><br>
            </b>
            <math xmlns="http://www.w3.org/1998/Math/MathML">
                <mi>EAx</mi>
                <mo>=</mo>
                <mn>0.0012794411714423525872</mn>
            </math>
                <br>
            <math xmlns="http://www.w3.org/1998/Math/MathML">
                <mi>ERx</mi>
                <mo>=</mo>
                <mn>0.00047068010316194824</mn>
            </math>
            <br><br>
            <b>
                b) 
                <math style="font-size: 18px">
                    <mi>p</mi>
                    <mo>=</mo>
                    <msup>
                        <mn>2</mn>
                        <mn>10</mn>
                    </msup>
                    <mo>,</mo>
                    <mspace width="0.3em"></mspace>
                    <mi>ṗ</mi>
                    <mo>=</mo>
                    <mn>1000</mn>
                    <mo>:</mo>
                </math>
                <br>
            </b>
            <math xmlns="http://www.w3.org/1998/Math/MathML">
                <mi>EAx</mi>
                <mo>=</mo>
                <mn>24.0</mn>
            </math>
            <br>
            <math xmlns="http://www.w3.org/1998/Math/MathML">
                <mi>ERx</mi>
                <mo>=</mo>
                <mn>0.0234375</mn>
            </math>
            <br><br>
            <b>
                c) 
                <math style="font-size: 18px">
                    <mi>p</mi>
                    <mo>=</mo>
                    <mtext>sen</mtext>
                    <mo>(</mo>
                    <mn>0.01</mn>
                    <mo>)</mo>
                    <mo>,</mo>
                    <mspace width="0.3em"></mspace>
                    <mi>ṗ</mi>
                    <mo>=</mo>
                    <mn>0</mn>
                    <mo>:</mo>
                </math>
                <br>
            </b>
            <math xmlns="http://www.w3.org/1998/Math/MathML">
                <mi>EAx</mi>
                <mo>=</mo>
                <mn>0.0099998333341666644641</mn>
            </math> <br>
            <math xmlns="http://www.w3.org/1998/Math/MathML">
                <mi>ERx</mi>
                <mo>=</mo>
                <mtext>1</mtext> 
            </math><br>
        </div>
    </div>
    <div id="questao2">
        <h4>
            2) Seja
            <math style="font-size: 20px" xmlns="http://www.w3.org/1998/Math/MathML">
                <mi>f</mi>
                <mtext>(</mtext>
                <mi>x</mi>
                <mtext>)</mtext>
                <mo>=</mo>
                <mfrac>
                    <mrow>
                        <mi>x</mi>
                        <mtext>cos</mtext>
                        <mo>(</mo>
                        <mi>x</mi>
                        <mo>)</mo>
                        <mo>-</mo>
                        <mtext>sen</mtext>
                        <mo>(</mo>
                        <mi>x</mi>
                        <mo>)</mo>
                    </mrow>
                    <mrow>
                        <mi>x</mi>
                        <mo>-</mo>
                        <mtext>sen</mtext>
                        <mo>(</mo>
                        <mi>x</mi>
                        <mo>)</mo>
                    </mrow>
                </mfrac>
            </math>
        </h4>
        <div id="respostaQuestao2">
            <b>
                a) Calcule <math style="font-size: 18px" xmlns="http://www.w3.org/1998/Math/MathML">
                    <msub>
                        <mtext>lim</mtext>
                        <mrow>
                            <mi>x</mi>
                            <mo>→</mo>
                            <mn>0</mn>
                        </mrow>
                    </msub>
                    <mi>f</mi>
                    <mtext>(</mtext>
                    <mi>x</mi>
                    <mtext>)</mtext>
                    <mo>=</mo>
                    <mn>-2</mn>
                </math>
                <a href="imgs/questao2-a.jpg" target="_blank">Resolução</a>
            </b>
            <br>
            <b>
                b) Usando 4 dígitos e arredondamento, resolva
                <math xmlns="http://www.w3.org/1998/Math/MathML">
                    <mi>f</mi>
                    <mtext>(</mtext>
                    <mn>0.01</mn>
                    <mtext>)</mtext>
                    <mo>=</mo>
                    <mn>-2.0000</mn>
                </math>
            </b>
            <br>
            <b>
                c) O valor real da expressão é 
                <math xmlns="http://www.w3.org/1998/Math/MathML">
                    <mi>f</mi>
                    <mtext>(</mtext>
                    <mn>0.01</mn>
                    <mtext>)</mtext>
                    <mo>=</mo>
                    <mn>−1.99899998</mn>
                </math>
                . Encontre o erro relativo ao que foi obtido no item (b).
                <br>
                <math xmlns="http://www.w3.org/1998/Math/MathML">
                    <mi>EAx</mi>
                    <mo>=</mo>
                    <mn>3.99899998</mn>
                </math>
                <br>
                <math xmlns="http://www.w3.org/1998/Math/MathML">
                    <mi>ERx</mi>
                    <mo>=</mo>
                    <mn>-1.99949999</mn>
                </math>
            </b>
        </div>
    </div>
    <div id="questao3">
        <h4>
            3) Seja um computador binário, cujo sistema de ponto flutuante tenha 1 bit para o sinal do número, <br>
            5 bits para o expoente e 6 bits para a mantissa, num total de 12 bits. Responda:
        </h4>
        <div id="respostaQuestao3">
            <b>
                a) Qual o menor número positivo e o maior número positivo nele representável?
            </b>
            <br>
            <math xmlns="http://www.w3.org/1998/Math/MathML">
                <msub>
                    <mn>000000000001</mn>
                    <mn>2</mn>
                </msub>
            </math>
            e 
            <math xmlns="http://www.w3.org/1998/Math/MathML">
                <msub>
                    <mn>011111111111</mn>
                    <mn>2</mn>
                </msub>
            </math>
            <br>
            <b>
                b) Qual o menor número maior que 4.25, nele representável? 
            </b>
            <br>
            <math xmlns="http://www.w3.org/1998/Math/MathML">
                <msub>
                    <mn>4.25</mn>
                    <mn>10</mn>
                </msub>
                <mo>=</mo>
                <msub>
                    <mn>100.01</mn>
                    <mn>2</mn>
                </msub>
                <mo>=</mo>
                <mn>1.0001</mn>
                <mo>*</mo>
                <msup>
                    <mn>2</mn>
                    <mn>4</mn>
                </msup>
                <mo>=</mo>
                <msub>
                    <mn>0 00100 010001</mn>
                    <mn>2</mn>
                </msub>
            </math>
            <br>
            O menor número maior que
            <math xmlns="http://www.w3.org/1998/Math/MathML">
                <msub>
                    <mn>100.01</mn>
                    <mn>2</mn>
                </msub>
            </math>
            seria 
            <math xmlns="http://www.w3.org/1998/Math/MathML">
                <msub>
                    <mn>100.1</mn>
                    <mn>2</mn>
                </msub>
                <mo>=</mo>
                <msub>
                    <mn>4.5</mn>
                    <mn>10</mn>
                </msub>
                <mo>=</mo>
                <mn>1.001</mn>
                <mo>*</mo>
                <msup>
                    <mn>2</mn>
                    <mn>3</mn>
                </msup>
                <mo>=</mo>
                <msub>
                    <mn>0 00011 001001</mn>
                    <mn>2</mn>
                </msub>
            </math>
            <br>
            <b>
                c) Qual o maior número menor que 80, nele representável?
            </b>
            <br>
            <math xmlns="http://www.w3.org/1998/Math/MathML">
                <msub>
                    <mn>80</mn>
                    <mn>10</mn>
                </msub>
                <mo>=</mo>
                <msub>
                    <mn>1010000</mn>
                    <mn>2</mn>
                </msub>
                <mo>=</mo>
                <mn>1.01</mn>
                <mo>*</mo>
                <msup>
                    <mn>2</mn>
                    <mn>6</mn>
                </msup>
                <mo>=</mo>
                <msub>
                    <mn>0 00110 000101</mn>
                    <mn>2</mn>
                </msub>
            </math>
            <br>
            O maior número menor que 
            <math xmlns="http://www.w3.org/1998/Math/MathML">
                <msub>
                    <mn>1010000</mn>
                    <mn>2</mn>
                </msub>
            </math>
            seria
            <math xmlns="http://www.w3.org/1998/Math/MathML">
                <msub>
                    <mn>1001110</mn>
                    <mn>2</mn>
                </msub>
                <mo>=</mo>
                <msub>
                    <mn>78</mn>
                    <mn>10</mn>
                </msub>
                <mo>=</mo>
                <mn>1.00111</mn>
                <mo>*</mo>
                <msup>
                    <mn>2</mn>
                    <mn>5</mn>
                </msup>
                <mo>=</mo>
                <msub>
                    <mn>0 00101 100111</mn>
                    <mn>2</mn>
                </msub>
            </math>
            <br>
            <b>
                d) Efetue, nele, a multiplicação 0.8 × 5 e indique o resultado.
            </b>
            <br>
            <math xmlns="http://www.w3.org/1998/Math/MathML">
                <msub>
                    <mn>0.8</mn>
                    <mn>10</mn>
                </msub>
                <mo>≅</mo>
                <msub>
                    <mn>1.10011</mn>
                    <mn>2</mn>
                </msub>
                <mo>≅</mo>
                <mn>1.10011</mn>
                <mo>*</mo>
                <msup>
                    <mn>2</mn>
                    <mrow>
                        <mo>-</mo>
                        <mn>1</mn>
                    </mrow>
                </msup>
                <mo>≅</mo>
                <msub>
                    <mn>0 10001 110011</mn>
                    <mn>2</mn>
                </msub>
            </math>
            <br>
            <math xmlns="http://www.w3.org/1998/Math/MathML">
                <msub>
                    <mn>5</mn>
                    <mn>10</mn>
                </msub>
                <mo>=</mo>
                <msub>
                    <mn>101</mn>
                    <mn>2</mn>
                </msub>
                <mo>=</mo>
                <mn>1.01</mn>
                <mo>*</mo>
                <msup>
                    <mn>2</mn>
                    <mn>2</mn>
                </msup>
                <mo>=</mo>
                <msub>
                    <mn>0 00010 000101</mn>
                    <mn>2</mn>
                </msub>
            </math>
            <br> 
            <math xmlns="http://www.w3.org/1998/Math/MathML">
                <mn>0.8</mn>
                <mo>*</mo>
                <mn>5</mn>
                <mo>=</mo>
                <mn>4</mn>
                <mo>≅</mo>
                <msub>
                    <mn>3.9375</mn>
                    <mn>10</mn>
                </msub>
                <mo>≅</mo>
                <msub>
                    <mn>11.1111</mn>
                    <mn>2</mn>
                </msub>
                <mo>≅</mo>
                <mn>1.11111</mn>
                <mo>*</mo>
                <msup>
                    <mn>2</mn>
                    <mn>1</mn>
                </msup>
                <mo>≅</mo>
                <msub>
                    <mn>0 00010 111111</mn>
                    <mn>2</mn>
                </msub>
            </math>
            <br>
            <math xmlns="http://www.w3.org/1998/Math/MathML">
            </math>
            <b>
                e) Represente o número 3.1 nesta máquina e calcule os erros absoluto e relativo da representação.
            </b>
            <br>
            <math xmlns="http://www.w3.org/1998/Math/MathML">
                <msub>
                    <mn>3.1</mn>
                    <mn>10</mn>
                </msub>
                <mo>≅</mo>
                <msub>
                    <mn>11.0001</mn>
                    <mn>2</mn>
                </msub>
                <mo>≅</mo>
                <mn>1.10001</mn>
                <mo>*</mo>
                <msup>
                    <mn>2</mn>
                    <mn>1</mn>
                </msup>
                <mo>≅</mo>
                <msub>
                    <mn>0 00001 110001</mn>
                    <mn>2</mn>
                </msub>
            </math>
            <br>
        </div>
    </div>
    <div id="questao4">
        <h4>
            4) A solução das equações do segundo grau no computador está sujeita a erros de arredondamento. <br>
            Lembrando que dado uma equação 
            <math xmlns="http://www.w3.org/1998/Math/MathML">
                <mrow>
                    <mi>a</mi>
                    <mo>&InvisibleTimes;</mo>
                    <msup>
                        <mi>x</mi>
                        <mn>2</mn>
                    </msup>
                    <mo>+</mo>
                    <mi>b</mi>
                    <mo>&InvisibleTimes;</mo>
                    <mi>x</mi>
                    <mo>+</mo>
                    <mi>c</mi>
                    <mo>=</mo>
                    <mn>0</mn>
                </mrow>
            </math>, as raízes seriam dadas por:
            <br>
            <math style="font-size: 25px" xmlns="http://www.w3.org/1998/Math/MathML">
                <mfrac>
                    <mrow>
                            <mo>-</mo>
                            <mi>b</mi>
                        <mo>±</mo>
                        <msqrt>
                            <msup>
                                <mi>b</mi>
                                <mn>2</mn>
                            </msup>
                            <mo>-</mo>
                            <mn>4</mn>
                            <mo>&InvisibleTimes;</mo>
                            <mi>a</mi>
                            <mo>&InvisibleTimes;</mo>
                            <mi>c</mi>
                        </msqrt>
                    </mrow>
                    <mrow>
                        <mn>2</mn>
                        <mo>&InvisibleTimes;</mo>
                        <mi>a</mi>
                    </mrow>
                </mfrac>
            </math>
        </h4>
        <div id="respostaQuestao4">
                <b>
                    a) Descreva o que pode ocorrer quando 
                    <math xmlns="http://www.w3.org/1998/Math/MathML">
                        <mi>b</mi>
                        <mo>></mo>
                        <mn>0</mn>
                        <mspace width="0.3em"></mspace>
                        <mtext>e</mtext>
                        <mspace width="0.3em"></mspace>
                        <mo>|</mo>
                        <msup>
                            <mi>b</mi>
                            <mn>2</mn>
                        </msup>
                        <mo>|</mo>
                        <mo>>></mo>
                        <mo>|</mo>
                        <mn>4</mn>
                        <mo>&InvisibleTimes;</mo>
                        <mi>a</mi>
                        <mo>&InvisibleTimes;</mo>
                        <mi>c</mi>
                        <mo>|</mo>
                    </math>
                    ?
                </b>
                <br>
                Utilizando o código:
                <div id="formulaBhaskara" style="white-space: pre-wrap; background-color: #EFF0F1;">def bhaskara(a, b, c):
                    from math import sqrt
                    delta=sqrt(b**2 - 4*a*c)
                    return (-b+delta)/2*a, (-b-delta)/2*a</div>
                Mostra que o delta tende a ficar muito grande (utilizei os valores a=1, b=10000 e c=1) e <br>
                as raízes achadas são, respectivamentes, mais próxima de zero (+) e mais próxima de delta (-). <br>
                <br>
                <b>
                    b) Uma forma de contornar isso é tomando 
                    <math xmlns="http://www.w3.org/1998/Math/MathML">
                        <mi>z</mi>
                        <mo>=</mo>
                        <mfrac>
                            <mn>1</mn>
                            <mi>x</mi>
                        </mfrac>
                    </math>
                    (
                    <math xmlns="http://www.w3.org/1998/Math/MathML">
                        <mi>x</mi>
                    </math>
                    não pode ser 0 caso 
                    <math xmlns="http://www.w3.org/1998/Math/MathML">
                        <mi>c</mi>
                        <mo>≠</mo>
                        <mn>0</mn>
                    </math>
                    ), fazendo com que se tenha a <br> 
                    equação do segundo grau (ao realizar o produto de
                    <math xmlns="http://www.w3.org/1998/Math/MathML">
                        <msup>
                            <mi>z</mi>
                            <mn>2</mn>
                        </msup>
                    </math>
                    em ambos os lados da igualdade): <br>
                    <math xmlns="http://www.w3.org/1998/Math/MathML">
                        <mi>a</mi>
                        <mo>+</mo>
                        <mi>b</mi>
                        <mo>&InvisibleTimes;</mo>
                        <mi>z</mi>
                        <mo>+</mo>
                        <mi>c</mi>
                        <mo>&InvisibleTimes;</mo>
                        <msup>
                            <mi>z</mi>
                            <mn>2</mn>
                        </msup>
                        <mo>=</mo>
                        <mn>0</mn>
                    </math>
                    <br><br>
                    Descreva qual seria a solução desta equação do segundo grau e diga como <br>
                    obter ambas as raízes de forma “segura” (usando ambas as formas).
                </b>
        </div>
    </div>
    <div id="questao5">
        <h4>
            5) Considere a razão:
            <math style="font-size: 20px" xmlns="http://www.w3.org/1998/Math/MathML">
                <mi>R</mi>
                <mo>=</mo>
                <mfrac>
                    <mrow>
                        <mi>n</mi>
                        <mo>&InvisibleTimes;</mo>
                        <mo>(</mo>
                        <mi>n</mi>
                        <mo>-</mo>
                        <mn>2</mn>
                        <mo>)</mo>
                        <mo>&InvisibleTimes;</mo>
                        <mo>(</mo>
                        <mi>n</mi>
                        <mo>-</mo>
                        <mn>4</mn>
                        <mo>)</mo>
                        <mo>&InvisibleTimes;</mo>
                        <mi>...</mi>
                        <mn>2</mn>
                    </mrow>
                    <mrow>
                        <mo>(</mo>
                        <mi>n</mi>
                        <mo>-</mo>
                        <mn>1</mn>
                        <mo>)</mo>
                        <mo>&InvisibleTimes;</mo>
                        <mo>(</mo>
                        <mi>n</mi>
                        <mo>-</mo>
                        <mn>3</mn>
                        <mo>)</mo>
                        <mo>&InvisibleTimes;</mo>
                        <mo>(</mo>
                        <mi>n</mi>
                        <mo>-</mo>
                        <mn>5</mn>
                        <mo>)</mo>
                        <mo>&InvisibleTimes;</mo>
                        <mi>...</mi>
                        <mn>1</mn>
                    </mrow>
                </mfrac>
            </math>
            <br><br>
            onde n é par. É de conhecimento que quando n = 100 e n = 400, tem-se
            R ≈ 12.5645 e R ≈ 25.0820, respectivamente.
        </h4>
    </div>
    <div id="respostaQuestao5">
        <b>
            a) O seguinte código (em teoria), cálcula o valor de R. Crie um programa na <br>
            linguagem que desejar e identifique porque este funciona quando n = 100 e <br>
            não funciona quando n = 400.
        </b>
            <div id="codProf" style="white-space: pre-wrap; background-color: #EFF0F1;">                n = 100
                T = 1.0
                B = 1.0
                for i = 2, i ≤ n, i+ = 2 do
                    T = T ∗ i
                for i = 1, i ≤ n − 1, i+ = 2 do
                    B = B ∗ i
                R = T/B</div>
        <br>
        Código feito em Python 3, para realizar essa questão:
        <div id="codProfPython" style="white-space: pre-wrap; background-color: #EFF0F1;">def codProf(n):
            T = 1.0
            B = 1.0
            for i in range(2, n, 2):
                T*=i
            print(T)
            for i in range(1, n-1, 2):
                B*=i
            print(B)
            return T/B</div>
        Com o valor de 100, o computador ainda consegue representar o número de T e B, ainda que em notação científica(o Python dá a notação de e). <br>
        <math style="font-size: 18px" xmlns="http://www.w3.org/1998/Math/MathML">
            <mrow>
                <mi>T</mi>
                <mo>=</mo>
                <mn>3.4243224702511974e+77</mn>
            </mrow>
        </math>
        <br>
        <math style="font-size: 18px" xmlns="http://www.w3.org/1998/Math/MathML">
            <mrow>
                <mi>B</mi>
                <mo>=</mo>
                <mn>2.752921353283565e+76</mn>
            </mrow>
        </math>
        <br>
        <math style="font-size: 18px" xmlns="http://www.w3.org/1998/Math/MathML">
            <mrow>
                <mfrac bevelled="true">
                    <mi>T</mi>
                    <mi>B</mi>
                </mfrac>
                <mo>=</mo>
                <mn>12.438867772836351</mn>
            </mrow>
        </math>
        <br>
        Já com o valor em 400, o Python não consegue armazenar o valor do inteiro e então passa a informar que T e B tem o valor de infinito (representado por <b>inf</b>). <br>
        Quando ele tenta dividir infinito por infinito ele informa que não é um número (representado por <b>nan</b>, que significa not a number).
        <br>
        <b>
            b) Reescreva o código anterior, de tal modo que o problema não ocorra mais. <br>
            OBS: Não altere as linhas 2 e 3 do código.
        </b>
        <br>
        Como o Python não consegue armazenar o valor sem que ele se "torne" infinito, """basta""" aumentar a precisão do ponto flutuante. <br>
        Para isso, eu alterei o código acima de duas maneiras distintas: <br>
        A primeira utilizando o <a href="http://www.numpy.org" target="_blank">NumPy</a> para me prover uma precisão maior, com o 
        <a href="https://docs.scipy.org/doc/numpy-1.13.0/user/basics.types.html#extended-precision" target="_blank">float128</a>:<br>
        <div id="codProfNumPy" style="white-space: pre-wrap; background-color: #EFF0F1;">def codProfNumPy(n):
            from numpy import float128
            T = 1.0
            B = 1.0
            for i in range(2, n, 2):
                T = float128(T*i)
            print(T)
            for i in range(1, n-1, 2):
                B = float128(B*i)
            print(B)
            return T/B</div>
        E a segunda utilizando <a href="https://gmpy2.readthedocs.io/en/latest/" target="_blank">gmpy2</a> 
        para providenciar o <a href="https://gmpy2.readthedocs.io/en/latest/mpfr.html" target="_blank">mpfr</a>:
        <div id="codProfNumPy" style="white-space: pre-wrap; background-color: #EFF0F1;">def codProfGmpy2(n):
            from gmpy2 import mpfr
            T = 1.0
            B = 1.0
            for i in range(2, n, 2):
                T = mpfr(T*i, 128)
            print(T)
            for i in range(1, n-1, 2):
                B = mpfr(B*i, 128)
            print(B)
            return T/B</div>
    </div>
</body>

</html>
